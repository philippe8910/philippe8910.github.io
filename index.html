<!DOCTYPE html>
<html>

<head>
  <title>Happy~~</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

  <style>
    .a-enter-vr-button {
      display: none !important;
    }
    #log {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      max-height: 150px;
      overflow-y: auto;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      font-size: 12px;
      padding: 5px;
      box-sizing: border-box;
      z-index: 9999;
    }
  </style>
</head>

<body style="margin: 0; overflow: hidden;">
  <a-scene embedded arjs="trackingMethod: best; sourceType: webcam;">
    <a-assets>
      <img id="image1" src="assets/Image/Forward.jpg" />
      <img id="image2" src="assets/Image/Back.jpg" />

      <audio id="audio1" src="assets/Audio/music.mp3"></audio>
      <audio id="audio2" src="assets/Audio/music.mp3"></audio>
    </a-assets>

    <!-- First NFT marker -->
    <a-nft type="nft" url="assets/Track/NTD/100-1" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
      <a-plane id="detected-image1" src="#image1" position="10 0 0" rotation="-90 0 0" width="180" height="300"></a-plane>
    </a-nft>

    <!-- Second NFT marker -->
    <a-nft type="nft" url="assets/Track/USD/100-1" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
      <a-plane id="detected-image2" src="#image2" position="0 0 0" rotation="-90 0 0" width="180" height="300"></a-plane>
    </a-nft>

    <a-entity camera></a-entity>
  </a-scene>

  <div id="log"></div>

  <script>
    function logMessage(message) {
      var logDiv = document.getElementById('log');
      logDiv.innerHTML += message + '<br>';
      console.log(message);
    }

    document.addEventListener('DOMContentLoaded', function () {
      AFRAME.registerComponent('play-audio-on-detect', {
        schema: { type: 'selector' },
        init: function () {
          var audio = this.data;
          var playing = false;
          this.el.addEventListener('arjs-nft-loaded', function () {
            logMessage('NFT detected, playing audio.');
            if (!playing) {
              audio.play();
              playing = true;
            }
          });
        }
      });

      var nft1 = document.querySelector('a-nft[url="assets/Track/NTD/100-1"]');
      var nft2 = document.querySelector('a-nft[url="assets/Track/USD/100-1"]');

      if (nft1) {
        nft1.setAttribute('play-audio-on-detect', '#audio1');
        logMessage('Component attached to NFT1');
      } else {
        logMessage('NFT1 not found');
      }

      if (nft2) {
        nft2.setAttribute('play-audio-on-detect', '#audio2');
        logMessage('Component attached to NFT2');
      } else {
        logMessage('NFT2 not found');
      }
    });
  </script>
</body>

</html>
